<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v6.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .axis {
            font: 20px sans-serif;
            font-weight: 500;
        }

        .tooltip {
            position: absolute;
        }

        .tooltipBar {
            display: block;
        }
    </style>
</head>

<body><!-- Create a div where the graph will take place -->

    <nav class="bg-white dark:bg-gray-900 w-full z-20 top-0 left-0 border-b border-gray-200 dark:border-gray-600">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <div class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1" id="navbar-sticky">
                <ul
                    class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
                    <li>
                        <a href="#"
                            class="block py-2 pl-3 pr-4 text-white bg-blue-700 rounded md:bg-transparent md:text-blue-700 md:p-0 md:dark:text-blue-500"
                            aria-current="page">Home</a>
                    </li>
                    <li>
                        <a href="#heatmapID"
                            class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Heatmap</a>
                    </li>
                    <li>
                        <a href="#scatterID"
                            class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Scatterplot</a>
                    </li>
                    <li>
                        <a href="#barplotID"
                            class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Barplot</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <section
        class="bg-center bg-no-repeat bg-[url('https://flowbite.s3.amazonaws.com/docs/jumbotron/conference.jpg')] bg-gray-700 bg-blend-multiply">
        <div class="px-4 mx-auto max-w-screen-xl text-center py-24 lg:py-56">
            <h1 class="mb-4 text-4xl font-extrabold tracking-tight leading-none text-white md:text-5xl lg:text-4xl">
                VISUALISASI DATA UNTUK MENGETAHUI KUALITAS SUSU</h1>
            <p class="mb-8 text-lg font-normal text-gray-300 lg:text-xl sm:px-16 lg:px-48">Visualisasi data ini
                bertujuan untuk mengetahui kualitas dari sebuah susu.
            </p>
            <div class="flex flex-col space-y-4 sm:flex-row sm:justify-center sm:space-y-0 sm:space-x-4">
                <a href="#"
                    class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-900">
                    Demo Visualisasi Data
                    <svg aria-hidden="true" class="ml-2 -mr-1 w-4 h-4" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </a>
                <a href="#info"
                    class="inline-flex justify-center hover:text-gray-900 items-center py-3 px-5 text-base font-medium text-center text-white rounded-lg border border-white hover:bg-gray-100 focus:ring-4 focus:ring-gray-400">
                    Why this dataset ?
                </a>
            </div>
        </div>
    </section>

    <div class="inline-flex items-center justify-center w-full my-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div class="mb-20">
        <p class="text-4xl font-bold text-center py-10">Our Team</p>
        <div class="flex justify-evenly text-center">
            <div>
                <img class="rounded-full w-48" src="/images/diky.JPG" alt="">
                <p class="text-lg font-bold pt-5">Diky Wahyudi</p>
                <p class="text-lg font-bold text-gray-500">2108107010031</p>
            </div>
            <div>
                <img class="rounded-full w-48" src="/images/dina.JPG" alt="">
                <p class="text-lg font-bold pt-5">Yahdina Ahsya</p>
                <p class="text-lg font-bold text-gray-500">2108107010055</p>
            </div>
            <div>
                <img class="rounded-full w-48" src="/images/rahma.jpeg" alt="">
                <p class="text-lg font-bold pt-5">Rahmatul Idami</p>
                <p class="text-lg font-bold text-gray-500">2108107010071</p>
            </div>
        </div>
    </div>


    <div class="inline-flex items-center justify-center w-full my-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div id="info" class="grid grid-cols-2 p-5 gap-5 border border-gray-200 rounded-xl m-5 bg-white shadow-xl">
        <div class="">
            <p class="text-xl font-bold pb-5">Why This Dataset ?</p>
            <p>Proyek kami menggunakan dataset “Milk Quality” untuk mengetahui tentang
                kualitas dari susu. Dimana dataset “Milk Quality” sangat membantu untuk memprediksi
                kualitas susu apakah susu tersebut low quality, medium quality dan high quality. Kualitas
                susu ini sangat penting untuk diketahui karena dapat digunakan untuk membantu para
                peternak dan pengecer dalam mengambil keputusan yang lebih baik terkait manajemen
                kualitas susu. Sehingga visualisasi dengan dataset ini akan sangat berguna untuk
                memperlihatkan dan menambah pengetahuan seputar kualitas susu.</p>

            <p class="text-xl font-bold py-5">About Dataset</p>
            <div>
                <p>Dataset “Milk Quality” adalah dataset yang berisi data mengenai faktor-faktor
                    yang mempengaruhi kualitas susu. Dataset ini disajikan dalam bentuk tabel yang
                    memiliki kolom dan baris. Banyak atribut yang dimiliki Dataset ini adalah 7 atribut
                    terdiri dari : pH (Numerik), temperature (Numerik), taste (Categorical), odor (Categorical), fat
                    (Categorical), turbidity (Categorical), colour (Categorical), dan grade (Categorical).</p>
            </div>
        </div>
        <div class="">
            <p class="text-md font-bold mb-5">Tujuan</p>
            <ol style="list-style-type: decimal" class="px-5">
                <li>Menganalisis kualitas susu berdasarkan atribut yang terdapat pada dataset "Milk
                    quality"</li>
                <li>Menemukan keterkaitan antara atribut yang terlibat pada dataset untuk
                    mengetahui pengaruh suatu atribut terhadap atribut lainnya</li>
                <li>Mengetahui korelasi antar data dari beberapa index untuk memahami penyebaran
                    data yang ada pada dataset</li>
                <li>Membandingkan frekuensi data pada dua atau lebih atribut untuk mengetahui
                    perbedaan kualitas susu pada atribut tersebut.</li>
            </ol>
            <p class="text-md font-bold my-5">Task</p>
            <ol style="list-style-type: decimal" class="px-5">
                <li>Membuat heatmap untuk menganalisis keterkaitan antara atribut pada dataset</li>
                <li>Membuat scatter plot untuk memahami korelasi antar data dari beberapa index
                    pada dataset</li>
                <li>Membuat bar plot untuk membandingkan frekuensi data pada dua atau lebih
                    atribut pada dataset</li>
            </ol>
        </div>
    </div>

    <div class="inline-flex items-center justify-center w-full my-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div id="heatmapID" class="grid md:grid-cols-5 grid-cols-1 mt-10 py-5 bg-[url('/images/milk.avif')] bg-cover">
        <div class="flex md:col-span-3 my-16 border border-gray-400 mx-10 bg-white rounded-xl">
            <div id="heatmap" class="m-5"></div>
            <div id="colorbar" class="py-5"></div>
        </div>
        <div class="md:col-span-2 backdrop-blur-md bg-lime-300/30 my-16 mr-10 p-5 rounded-xl text-justify">
            <p class="text-xl font-bold">Heatmap</p>
            <p>
                Pada Heatmap ini akan memperlihatkan bagaimana kualitas susu dapat
                dikelompokkan berdasarkan atribut yang ada. Pada dataset kualitas susu ini diberi
                label dengan 3 kategori yaitu high, low, dan medium yaitu atribut grade. Dari
                visualisasi heatmap ini terlihat kotak yang memiliki warna coklat lebih pekat artinya
                memiliki korelasi paling kuat dan semakin pudar berarti lebih lemah pula
                korelasinya. Terlihat yang paling pekat itu tentunya ada pada variabel yang sama,
                selain itu untuk korelasi yang paling bagus adalah turbidity dan odor, ph dan
                temperature, serta fat dan taste. Adapun variabel yang memiliki banyak korelasi baik
                dengan variabel lainnya adalah turbidity dan fat.
            </p>
        </div>
    </div>
    <script>
        function heatmap() {
            // set the dimensions and margins of the graph
            const margin = { top: 80, right: 25, bottom: 80, left: 90 },
                width = 600 - margin.left - margin.right,
                height = 600 - margin.top - margin.bottom;

            // append the svg object to the body of the page
            const svg = d3.select("#heatmap")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left}, ${margin.top})`);

            // append the svg object to the body of the page
            const colorbar = d3.select("#colorbar")
                .append("svg")
                .attr("width", 100)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")

            //Read the data
            d3.csv("korelasi.csv").then(function (data) {
                console.log(data);

                // Labels of row and columns -> unique identifier of the column called 'group' and 'variable'
                const myGroups = ["pH", "Temprature", "Taste", "Odor", "Fat", "Turbidity", "Colour"]
                const myVars = ["pH", "Temprature", "Taste", "Odor", "Fat", "Turbidity", "Colour"]

                // Build X scales and axis:
                const x = d3.scaleBand()
                    .range([0, width])
                    .domain(myGroups)
                    .padding(0.05);
                svg.append("g")
                    .style("font-size", 15)
                    .attr("transform", `translate(0, ${height})`)
                    .call(d3.axisBottom(x).tickSize(0))
                    .select(".domain").remove()

                // Build Y scales and axis:
                const y = d3.scaleBand()
                    .range([height, 0])
                    .domain(myVars)
                    .padding(0.05);
                svg.append("g")
                    .style("font-size", 15)
                    .call(d3.axisLeft(y).tickSize(0))
                    .select(".domain").remove()

                // Build color scale
                const myColor = d3.scaleSequential()
                    .range(["#fefce8", "#facc15"])
                    .domain([0, 1])

                // create a tooltip
                const tooltip = d3.select("#heatmap")
                    .append("div")
                    .style("opacity", 0)
                    .attr("class", "tooltip")
                    .style("background-color", "white")
                    .style("border", "solid")
                    .style("border-width", "2px")
                    .style("border-radius", "5px")
                    .style("padding", "5px")

                // Three function that change the tooltip when user hover / move / leave a cell
                const mouseover = function (event, d) {
                    tooltip
                        .style("opacity", 1)
                    d3.select(this)
                        .style("stroke", "orange")
                        .style("opacity", 1)
                }
                const mousemove = function (event, d) {
                    tooltip
                        .html("The exact value of<br>this cell is: " + d.Korelasi)
                        .style("left", (event.x) + "px")
                        .style("top", (event.y) + "px")
                }
                const mouseleave = function (event, d) {
                    tooltip
                        .style("opacity", 0)
                    d3.select(this)
                        .style("stroke", "none")
                        .style("opacity", 1)
                }

                const f = d3.format(".3f");
                // add the squares
                svg.selectAll()
                    .data(data, function (d) { return d.Fitur1 + ':' + d.Fitur2; })
                    .join("rect")
                    .attr("x", function (d) { return x(d.Fitur1) })
                    .attr("y", function (d) { return y(d.Fitur2) })
                    .attr("rx", 4)
                    .attr("ry", 4)
                    .attr("width", x.bandwidth())
                    .attr("height", y.bandwidth())
                    .style("fill", function (d) { return myColor(d.Korelasi) })
                    .style("stroke-width", 4)
                    .style("stroke", "none")
                    .style("opacity", 0.8)
                    .on("mouseover", mouseover)
                    .on("mousemove", mousemove)
                    .on("mouseleave", mouseleave)

                var bar = svg
                    .selectAll(".label")
                    .data(data)
                    .enter()
                    .append("g")
                    .attr("class", "label")
                    .attr("transform", "translate(15,30)");
                bar
                    .append("text")
                    .attr("x", (d) => x(d.Fitur1))
                    .attr("y", (d) => y(d.Fitur2))
                    .attr("dy", ".35em")
                    .style("font-size", "14px")
                    .text((d) => f(d.Korelasi));
            })

            var colors = ['#facc15', '#fefce8'];

            var grad = colorbar.append('defs')
                .append('linearGradient')
                .attr('id', 'grad')
                .attr('x1', '0%')
                .attr('x2', '0%')
                .attr('y1', '0%')
                .attr('y2', '100%');

            grad.selectAll('stop')
                .data(colors)
                .enter()
                .append('stop')
                .style('stop-color', function (d) { return d; })
                .attr('offset', function (d, i) {
                    return 100 * (i / (colors.length - 1)) + '%';
                })

            colorbar.append('rect')
                .attr('x', 0)
                .attr('y', 80)
                .attr('width', 20)
                .attr('height', 400)
                .style('fill', 'url(#grad)');

            colorbar.append("text")
                .attr("x", 20)
                .attr("y", 83)
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .text("- 1");

            colorbar.append("text")
                .attr("x", 20)
                .attr("y", 283)
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .text("- 0.5");

            colorbar.append("text")
                .attr("x", 20)
                .attr("y", 483)
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .text("- 0");

            // Add title to graph
            svg.append("text")
                .attr("x", 0)
                .attr("y", -50)
                .attr("text-anchor", "left")
                .style("font-size", "22px")
                .text("Korelasi Antar Atribut pada dataset milknew");

            // Add subtitle to graph
            svg.append("text")
                .attr("x", 0)
                .attr("y", -20)
                .attr("text-anchor", "left")
                .style("font-size", "14px")
                .style("fill", "grey")
                .style("max-width", 400)
                .text("Visualisasi ini di buat untuk mengetahui korelasi antar atribut");
        }
        heatmap();
    </script>

    <div class="inline-flex items-center justify-center w-full my-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div id="scatterID" class="grid grid-cols-6 py-20 bg-[url('/images/milk.jpg')] bg-cover">
        <div class="col-span-2 bg-white/50 backdrop-blur-md rounded-xl mx-5 p-5 text-justify">
            <p class="text-xl font-bold">Scatterplot</p>
            <p>
                Gambar diatas adalah scatterplot yang menggunakan variabel pH dan temperatur.
                Kedua variabel ini digunakan karena berdasarkan heatmap, mereka termasuk yang
                memiliki korelasi paling bagus. Selain itu, pH dan temperatur bertipe data numerik,
                dimana hal ini akan semakin mendukung kedua variabel tersebut digunakan pada
                visualisasi data dengan scatterplot. Diketahui dari visualisasi di atas, pH susu
                berpengaruh dengan temperatur dari ruangan tempat penyimpanan susu. pH susu
                yang berkualitas tinggi dan sedang yaitu dengan titik berwarna merah dan kuning,
                terletak pada rentang 6-7. Dimana pH 6-7 didapatkan dari temperatur 34 - 45C.
                Sehingga dengan visualisasi data ini dapat diketahui untuk mendapatkan kualitas
                susu yang tinggi harus menjaga suhu susu pada temperatur 34 - 45C agar
                mendapatkan susu dengan pH 6-7.
            </p>
        </div>
        <div id="scatter" class="flex flex-row-reverse items-center col-span-4 px-5 py-5 bg-white mr-5 rounded-xl">
            <div>
                <div class="p-1 border border-2 border-gray-400 rounded-xl">
                    <button id="highButton" class="flex p-2 hover:bg-green-100 rounded-xl w-full">
                        <div class="h-3 w-3 rounded-full bg-green-400 mr-2"></div>
                        <p class="text-xs">High</p>
                    </button>
                    <button id="mediumButton" class="flex p-2 hover:bg-yellow-100 rounded-xl w-full">
                        <div class="h-3 w-3 rounded-full bg-yellow-400 mr-2"></div>
                        <p class="text-xs">Medium</p>
                    </button>
                    <button id="lowButton" class="flex p-2 hover:bg-red-100 rounded-xl w-full">
                        <div class="h-3 w-3 rounded-full bg-red-400 mr-2"></div>
                        <p class="text-xs">Low</p>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        function scatter() {
            // set the dimensions and margins of the graph
            const marginScatter = { top: 60, right: 30, bottom: 60, left: 60 },
                widthScatter = 750 - marginScatter.left - marginScatter.right,
                heightScatter = 580 - marginScatter.top - marginScatter.bottom;

            // append the svg object to the body of the page
            const svgScatter = d3.select("#scatter")
                .append("svg")
                .attr("width", widthScatter + marginScatter.left + marginScatter.right)
                .attr("height", heightScatter + marginScatter.top + marginScatter.bottom)
                .append("g")
                .attr("transform", `translate(${marginScatter.left}, ${marginScatter.top})`);

            //Read the data
            d3.csv("milknew.csv").then(function (data) {

                // Add X axis
                const x = d3.scaleLinear()
                    .domain([0, 10])
                    .range([0, widthScatter]);
                svgScatter.append("g")
                    .attr("transform", `translate(0, ${heightScatter})`)
                    .call(d3.axisBottom(x));

                // Add Y axis
                const y = d3.scaleLinear()
                    .domain([0, 100])
                    .range([heightScatter, 0]);
                svgScatter.append("g")
                    .call(d3.axisLeft(y));

                // // Color scale: give me a specie name, I return a color
                // const color = d3.scaleOrdinal()
                //     .domain(["high", "medium", "low"])
                //     .range(["#f87171", "#facc15", "#4ade80"])

                // Highlight the specie that is hovered
                const highlight = function (event, d) {

                    selected_specie = d.Grade

                    d3.selectAll(".dot")
                        .transition()
                        .duration(200)
                        .style("fill", "lightgrey")
                        .attr("r", 3)

                    d3.selectAll("." + selected_specie)
                        .transition()
                        .duration(200)
                        .style("fill", color(selected_specie))
                        .attr("r", 7)
                }

                // Highlight the specie that is hovered
                const doNotHighlight = function (event, d) {
                    d3.selectAll(".dot")
                        .transition()
                        .duration(200)
                        .style("fill", d => color(d.Grade))
                        .attr("r", 4)
                }

                const color = d3.scaleOrdinal()
                    .domain(["low", "medium", "high"])
                    .range(["#f87171", "#facc15", "#4ade80"])
                var pilih = 0;
                var selectGrade = "";
                var gradeName = { high: 'high', medium: 'medium', low: 'low' };
                function highlightState(grade) {
                    if (pilih == 0 || selectGrade != grade) {
                        pilih = 1;
                        selected_specie = grade;

                        d3.selectAll(".dot")
                            .transition()
                            .duration(200)
                            .style("fill", "lightgrey")
                            .attr("r", 3)

                        d3.selectAll("." + selected_specie)
                            .transition()
                            .duration(200)
                            .style("fill", color(selected_specie))
                            .attr("r", 7)

                        selectGrade = grade;
                    } else {
                        pilih = 0;
                        d3.selectAll(".dot")
                            .transition()
                            .duration(200)
                            .style("fill", d => color(d.Grade))
                            .attr("r", 4)

                        selectGrade = grade;
                    }
                }

                // Add dots
                svgScatter.append('g')
                    .selectAll("dot")
                    .data(data)
                    .enter()
                    .append("circle")
                    .attr("class", function (d) { return "dot " + d.Grade })
                    .attr("cx", function (d) { return x(d.pH); })
                    .attr("cy", function (d) { return y(d.Temprature); })
                    .attr("r", 4)
                    .style("fill", function (d) { return color(d.Grade) })
                    .on("mouseover", highlight)
                    .on("mouseleave", doNotHighlight)

                const highButton = document.getElementById("highButton");
                highButton.addEventListener("click", function () {
                    highlightState(gradeName.high);
                });

                const mediumButton = document.getElementById("mediumButton");
                mediumButton.addEventListener("click", function () {
                    highlightState(gradeName.medium);
                });
                const lowButton = document.getElementById("lowButton");
                lowButton.addEventListener("click", function () {
                    highlightState(gradeName.low);
                });

                // Add title to graph
                svgScatter.append("text")
                    .attr("x", 0)
                    .attr("y", -40)
                    .attr("text-anchor", "left")
                    .style("font-size", "22px")
                    .text("Persebaran grade berdasarkan pH dan Temperature dari susu");

                // Add subtitle to graph
                svgScatter.append("text")
                    .attr("x", 0)
                    .attr("y", -20)
                    .attr("text-anchor", "left")
                    .style("font-size", "14px")
                    .style("fill", "grey")
                    .style("max-width", 400)
                    .text("Visualisasi ini di buat untuk mengetahui persebaran kualitas susu berdasarkan pH dan Temperature");

                svgScatter.append("text")      // text label for the x axis
                    .attr("x", (widthScatter) / 2)
                    .attr("y", heightScatter + 40)
                    .style("text-anchor", "middle")
                    .text("pH");

                svgScatter.append("text")      // text label for the x axis
                    .attr("x", -220)
                    .attr("y", -40)
                    .attr("transform", "rotate(-90)")
                    .style("text-anchor", "middle")
                    .text("Temperature");
            });
        }
        scatter();
    </script>

    <div class="inline-flex items-center justify-center w-full my-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div id="barplotID"
        class="flex gap-5 justify-center grid grid-cols-6 px-10 py-20 bg-[url('/images/susu.jpg')] bg-cover">
        <div class="flex col-span-4 bg-white rounded-xl">
            <div id="barplot"></div>
            <div id="barplotLegend" class="flex flex-row-reverse items-center">
                <div class="w-48">
                    <div
                        class="p-1 pb-2 border border-2 border-b-0 border-gray-400 rounded-xl rounded-b-none font-medium">
                        <div class="flex w-full justify-center py-1">
                            <p id="Title" class="text-normal font-bold"></p>
                        </div>
                        <div class="flex">
                            <div class="h-3 w-3 rounded-full bg-red-400 mr-2"></div>
                            <p id="falseText" class="text-xs"></p>
                        </div>
                        <div class="flex">
                            <div class="h-3 w-3 rounded-full bg-blue-400 mr-2"></div>
                            <p id="trueText" class="text-xs"></p>
                        </div>
                    </div>
                    <select id="tipe" onchange="updateData()"
                        class="bg-white border border-2 border-gray-400 text-gray-600 text-sm rounded-xl rounded-t-none block w-full p-2.5 font-bold">
                        <option value="Taste" selected>Taste</option>
                        <option value="Odor">Odor</option>
                        <option value="Fat">Fat</option>
                        <option value="Turbidity">Turbidity</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="col-span-2 bg-white/50 backdrop-blur-xl rounded-xl p-5 text-justify">
            <p class="text-xl font-bold">Barplot</p>
            <p>
                Gambar diatas menunjukkan visualisasi data dengan barplot menggunakan
                atribut taste, dimana bar berwarna merah untuk susu yang memiliki rasa yang
                buruk dan biru untuk susu yang memiliki rasa yang baik. Tujuan visualisasi ini
                untuk memperlihatkan perbedaan dari setiap grade susu yang dipengaruhi oleh
                atribut taste. Terlihat pada visualisasi diatas susu dengan kualitas high dan low
                sama2 lebih banyak yang memiliki rasa yang baik, sedangkan susu dengan
                kualitas medium lebih banyak memiliki rasa yang buruk. Mungkin, rasa yang baik
                atau buruk pada susu tidak bisa dijadikan tolak ukur yang kuat untuk menentukan
                kualitas susu karena terlihat pada low dan high memiliki kesamaan perbandingan
                untuk variabel ini.
            </p>
        </div>
    </div>
    <script>
        // set the dimensions and margins of the graph
        const marginBar = { top: 80, right: 30, bottom: 60, left: 60 },
            widthBar = 610 - marginBar.left - marginBar.right,
            heightBar = 550 - marginBar.top - marginBar.bottom;

        // append the svg object to the body of the page
        const svgBar = d3.select("#barplot")
            .append("svg")
            .attr("width", widthBar + marginBar.left + marginBar.right)
            .attr("height", heightBar + marginBar.top + marginBar.bottom)
            .append("g")
            .attr("transform", `translate(${marginBar.left},${marginBar.top})`);

        // List of subgroups = header of the csv files = soil condition here
        const subgroups = ["False", "True"]

        // List of groups = species here = value of the first column called group -> I show them on the X axis
        const groups = ["high", "medium", "low"]

        // Add X axis
        const x = d3.scaleBand()
            .domain(groups)
            .range([0, widthBar])
            .padding([0.2])

        svgBar.append("g")
            .attr("transform", `translate(0, ${heightBar})`)
            .attr("class", "axis")
            .call(d3.axisBottom(x).tickSize(0));

        // Add Y axis
        const y = d3.scaleLinear()
            .domain([0, 400])
            .range([heightBar, 0]);

        svgBar.append("g")
            .call(d3.axisLeft(y));

        // Another scale for subgroup position?
        const xSubgroup = d3.scaleBand()
            .domain(subgroups)
            .range([0, x.bandwidth()])
            .padding([0.05])

        // color palette = one color per subgroup
        const colorBar = d3.scaleOrdinal()
            .domain(subgroups)
            .range(['#f87171', '#60a5fa'])

        // create a tooltip
        const tooltip = d3.select("#barplot")
            .append("div")
            .style("opacity", 0)
            .attr("class", "tooltipBar")
            .style("background-color", "white")
            .style("border", "solid")
            .style("border-width", "2px")
            .style("border-radius", "5px")
            .style("padding", "5px")

        function updateData() {
            var dataset = document.getElementById("tipe").value;
            var result = dataset.concat(".csv");

            var dataKeterangan = {
                Fat: { Title: "Kadar Lemak", False: "Sedikit Lemak", True: "Banyak lemak" },
                Taste: { Title: "Rasa", False: "Buruk", True: "Baik" },
                Odor: { Title: "Bau", False: "Berbau", True: "Tidak Berbau" },
                Turbidity: { Title: "Tingkat Kekeruhan", False: "Rendah", True: "Tinggi" }
            };

            document.getElementById("Title").innerHTML = dataKeterangan[dataset].Title;
            document.getElementById("falseText").innerHTML = dataKeterangan[dataset].False;
            document.getElementById("trueText").innerHTML = dataKeterangan[dataset].True;

            // console.log(dataKeterangan);

            // Parse the Data
            d3.csv(result).then(function (data) {
                d3.selectAll("#barplotRect").remove()


                // Three function that change the tooltip when user hover / move / leave a cell
                const mouseover = function (event, d) {
                    tooltip
                        .style("opacity", 1)
                    d3.select(this)
                        .style("stroke", "black")
                        .style("opacity", 1)
                }
                const mousemove = function (event, d) {
                    console.log(event.x, event.y);
                    tooltip
                        .html("The exact value of<br>this cell is: " + d.value)
                        .style("left", (event.x) + "px")
                        .style("top", (event.y) + "px")
                }
                const mouseleave = function (event, d) {
                    tooltip
                        .style("opacity", 0)
                    d3.select(this)
                        .style("stroke", "none")
                        .style("opacity", 1)
                }
                // Show the bars
                svgBar.append("g")
                    .selectAll("g")
                    .data(data)
                    .join("g")
                    .attr("transform", d => `translate(${x(d.Grade)}, 0)`)
                    .selectAll("rect")
                    .data(function (d) {
                        return subgroups.map(function (key) {
                            return { key: key, value: d[key] };
                        });
                    })
                    .join("rect")
                    .attr("id", "barplotRect")
                    .attr("x", d => xSubgroup(d.key))
                    .attr("y", d => y(d.value))
                    .attr("width", xSubgroup.bandwidth())
                    .attr("height", d => heightBar - y(d.value))
                    .attr("fill", d => colorBar(d.key))
                    .on("mouseover", mouseover)
                    .on("mousemove", mousemove)
                    .on("mouseleave", mouseleave);
            })
        }

        updateData();

        // text label for the y axis
        svgBar.append("text")
            .attr("x", -300)
            .attr("y", -40)
            .attr("transform", "rotate(-90)")
            .style("text-anchor", "middle")
            .text("Jumlah");

        // Add title to graph
        svgBar.append("text")
            .attr("x", 0)
            .attr("y", -40)
            .attr("text-anchor", "left")
            .style("font-size", "22px")
            .text("Grafik perbandingan dari Taste,Odor,Fat dan Turbidity");

        // Add subtitle to graph
        svgBar.append("text")
            .attr("x", 0)
            .attr("y", -20)
            .attr("text-anchor", "left")
            .style("font-size", "14px")
            .style("fill", "grey")
            .style("max-width", 400)
            .text("Visualisasi ini di buat untuk mengetahui perbedaan dari setiap grade susu");
    </script>

    <div class="inline-flex items-center justify-center w-full mt-10">
        <hr class="w-full h-1 my-8 bg-gray-200 border-0 rounded dark:bg-gray-700">
        <div class="absolute px-4 -translate-x-1/2 bg-white left-1/2 dark:bg-gray-900">
            <svg aria-hidden="true" class="w-5 h-5 text-gray-700 dark:text-gray-300" viewBox="0 0 24 27" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.017 18L14.017 10.609C14.017 4.905 17.748 1.039 23 0L23.995 2.151C21.563 3.068 20 5.789 20 8H24V18H14.017ZM0 18V10.609C0 4.905 3.748 1.038 9 0L9.996 2.151C7.563 3.068 6 5.789 6 8H9.983L9.983 18L0 18Z"
                    fill="currentColor" />
            </svg>
        </div>
    </div>

    <div class="p-5 m-5 mb-20">
        <p class="text-4xl font-bold text-center py-5 pb-20">Sumber Inspirasi Visualisasi Data</p>
        <div class="flex justify-evenly">
            <img class="" src="/images/inspirasi.png" alt="">
            <img src="/images/inspirasi2.png" alt="">
        </div>
    </div>

    <div class="fixed right-6 bottom-6 group">
        <a href="#"
            class="flex items-center justify-center text-white bg-blue-700 rounded-full w-14 h-14 hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 focus:outline-none dark:focus:ring-blue-800">
            <svg aria-hidden="true" class="w-8 h-8 transition-transform group-hover:rotate-45" fill="none"
                stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6">
                </path>
            </svg>
        </a>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js"></script>

</body>